[REQUEST]
diff --git a/sources/manifest.json b/sources/manifest.json
index 996abca..bdf0a20 100644
--- a/sources/manifest.json
+++ b/sources/manifest.json
@@ -23,12 +23,13 @@
   "content_scripts": [
     {
       "matches": [
-        "https://chatgpt.com/*",
-        "https://gemini.google.com/*",
-        "https://aistudio.google.com/*",
-        "https://claude.ai/*"
+        "https://*/*",
+        "http://*/*"
       ],
-      "js": ["src/content.js"]
+      "js": [
+        "src/sites.js",
+        "src/content.js"
+      ]
     }
   ]
 }
\ No newline at end of file
diff --git a/sources/src/background.js b/sources/src/background.js
index 53406c4..3e353cc 100644
--- a/sources/src/background.js
+++ b/sources/src/background.js
@@ -1,3 +1,11 @@
+// sites registry (builtin/custom)
+try {
+  // background(service_worker)ëŠ” extension root ê¸°ì¤€ ê²½ë¡œê°€ ì•ˆì „í•¨
+  importScripts('src/sites.js');
+} catch (_) {
+  // ignore
+}
+
 // ìƒíƒœ ê´€ë¦¬ ë³€ìˆ˜
 // ìš”êµ¬ì‚¬í•­(3ìƒíƒœ):
 //   - WHITE : ì•„ë¬´ ì§ˆë¬¸ ì—†ìŒ / ì½ìŒ / (ğŸŸ¢ì—ì„œ í´ë¦­Â·ìŠ¤í¬ë¡¤ë¡œ í™•ì¸ í›„)
@@ -5,6 +13,24 @@
 //   - GREEN : ìƒì„±ì™„ë£Œ(í´ë¦­Â·ìŠ¤í¬ë¡¤ë¡œ í™•ì¸ ì „)
 let tabStates = {}; // { tabId: { status: 'WHITE' | 'ORANGE' | 'GREEN', platform: '' } }
 let settings = { dndMode: false };
+let _siteConfigCache = { enabledSites: null, customSites: [] };
+
+function getSiteConfig(cb) {
+  const sitesApi = globalThis?.ReadyAi?.sites;
+  const enabledKey = sitesApi?.STORAGE_KEYS?.ENABLED_SITES || 'enabledSites';
+  const customKey = sitesApi?.STORAGE_KEYS?.CUSTOM_SITES || 'customSites';
+
+  chrome.storage.local.get([enabledKey, customKey], (res) => {
+    const enabledSites = sitesApi?.ensureEnabledSitesObject
+      ? sitesApi.ensureEnabledSitesObject(res?.[enabledKey])
+      : (res?.[enabledKey] || {});
+    const customSites = sitesApi?.normalizeCustomSites
+      ? sitesApi.normalizeCustomSites(res?.[customKey])
+      : (res?.[customKey] || []);
+    _siteConfigCache = { enabledSites, customSites };
+    cb?.(_siteConfigCache);
+  });
+}
 // ì´ˆê¸° ì„¤ì • ë¡œë“œ
 chrome.storage.local.get(['dndMode'], (res) => {
   if (res.dndMode) settings.dndMode = res.dndMode;
@@ -12,7 +38,14 @@ chrome.storage.local.get(['dndMode'], (res) => {
 // ì„¤ì • ë³€ê²½ ê°ì§€ (Popupì—ì„œ ë³€ê²½ ì‹œ)
 chrome.storage.onChanged.addListener((changes) => {
   if (changes.dndMode) settings.dndMode = changes.dndMode.newValue;
+  if (changes.enabledSites || changes.customSites) {
+    // ëª¨ë‹ˆí„°ë§ ëŒ€ìƒì—ì„œ ë¹ ì§„ íƒ­ì€ ìƒíƒœë¥¼ ì§€ì›Œì„œ "ë“±ë¡ëœ ì‚¬ì´íŠ¸ë§Œ" ê´€ë¦¬ë˜ë„ë¡.
+    getSiteConfig(() => purgeDisabledTabs());
+  }
 });
+
+// ì„œë¹„ìŠ¤ì›Œì»¤ ì‹œì‘ ì‹œì—ë„ í•œë²ˆ ìºì‹œ
+getSiteConfig();
 // ì•„ì´ì½˜ ì—…ë°ì´íŠ¸ í•¨ìˆ˜
 function updateIcon(tabId) {
   const state = tabStates[tabId]?.status || 'WHITE';
@@ -58,6 +91,7 @@ chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
   if (message.action === 'status_update') {
     const prev = tabStates[tabId]?.status;
     const platform = message.platform;
+    const siteName = message.siteName;
     // 1) ìƒì„±ì¤‘ì´ë©´ ë¬´ì¡°ê±´ ORANGE
     if (message.isGenerating) {
       tabStates[tabId] = { status: 'ORANGE', platform };
@@ -79,7 +113,7 @@ chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
       // íƒ­ì´ í˜„ì¬ ë¹„í™œì„±ì´ë©´(ë‹¤ë¥¸ íƒ­ ë³´ê³  ìˆìœ¼ë©´) ì•Œë¦¼ì„ ë³´ë‚¼ ìˆ˜ ìˆìŒ
       chrome.tabs.query({ active: true, currentWindow: true }, (tabs) => {
         const isActiveTab = tabs.length > 0 && tabs[0].id === tabId;
-        if (!isActiveTab && !settings.dndMode) sendNotification(platform);
+        if (!isActiveTab && !settings.dndMode) sendNotification(platform, siteName);
       });
       return;
     }
@@ -101,11 +135,15 @@ chrome.runtime.onMessage.addListener((message, sender, sendResponse) => {
     }
   }
 });
-function sendNotification(platform) {
-  let title = "AI ë‹µë³€ ì™„ë£Œ";
-  if (platform === 'chatgpt') title = "ChatGPT ë‹µë³€ ì™„ë£Œ";
-  else if (platform === 'gemini') title = "Gemini ë‹µë³€ ì™„ë£Œ";
-  else if (platform === 'aistudio') title = "AI Studio ë‹µë³€ ì™„ë£Œ";
+function sendNotification(platform, siteName) {
+  let title = siteName ? `${siteName} ë‹µë³€ ì™„ë£Œ` : "AI ë‹µë³€ ì™„ë£Œ";
+  // í˜¸í™˜/ë°±ì—…: siteNameì´ ì—†ì„ ë•Œë§Œ í”Œë«í¼ë³„ë¡œ ì¹˜í™˜
+  if (!siteName) {
+    if (platform === 'chatgpt') title = "ChatGPT ë‹µë³€ ì™„ë£Œ";
+    else if (platform === 'gemini') title = "Gemini ë‹µë³€ ì™„ë£Œ";
+    else if (platform === 'aistudio') title = "AI Studio ë‹µë³€ ì™„ë£Œ";
+    else if (platform === 'claude') title = "Claude ë‹µë³€ ì™„ë£Œ";
+  }
   chrome.notifications.create({
     type: 'basic',
     iconUrl: 'assets/bell_notice.png',
@@ -125,4 +163,32 @@ chrome.notifications.onClicked.addListener(() => {
   // (í´ë¦­/ìŠ¤í¬ë¡¤ë¡œë§Œ âšªë¡œ ì „í™˜)
 });
 // íƒ­ ë‹«í˜ ì •ë¦¬
-chrome.tabs.onRemoved.addListener((tabId) => { delete tabStates[tabId]; });
\ No newline at end of file
+chrome.tabs.onRemoved.addListener((tabId) => { delete tabStates[tabId]; });
+
+function isMonitoredUrl(url) {
+  if (!url || !(url.startsWith('http://') || url.startsWith('https://'))) return false;
+  const sitesApi = globalThis?.ReadyAi?.sites;
+  if (!sitesApi?.resolveSiteFromConfig) return true; // fallback
+  try {
+    const site = sitesApi.resolveSiteFromConfig(url, _siteConfigCache.enabledSites, _siteConfigCache.customSites);
+    return !!site;
+  } catch (_) {
+    return true;
+  }
+}
+
+function purgeDisabledTabs() {
+  chrome.tabs.query({}, (tabs) => {
+    for (const t of tabs) {
+      if (!t?.id) continue;
+      if (!tabStates[t.id]) continue;
+      const url = t.url || '';
+      if (!url) continue;
+      if (isMonitoredUrl(url)) continue;
+
+      // ë” ì´ìƒ ë“±ë¡ëœ ì‚¬ì´íŠ¸ê°€ ì•„ë‹ˆë©´ ìƒíƒœ ì •ë¦¬ + ì•„ì´ì½˜ í°ìƒ‰ìœ¼ë¡œ
+      delete tabStates[t.id];
+      updateIcon(t.id);
+    }
+  });
+}
\ No newline at end of file
diff --git a/sources/src/content.js b/sources/src/content.js
index b70c9d2..9de8adb 100644
--- a/sources/src/content.js
+++ b/sources/src/content.js
@@ -1,6 +1,14 @@
+// NOTE:
+// - content scriptëŠ” <all_urls>ì— ì£¼ì…ëœë‹¤.
+// - í•˜ì§€ë§Œ ì‹¤ì œ ê°ì‹œëŠ” "ë“±ë¡/í™œì„±"ëœ ì‚¬ì´íŠ¸ì—ì„œë§Œ ì‹¤í–‰í•œë‹¤.
+
+let activeSite = null; // { key, name, detection }
+let monitoring = false;
+
 let isGenerating = false;
 let checkInterval = null;
 let completionStatus = 'idle'; // 'idle' | 'completed'
+
 // ìµœì´ˆ 1íšŒëŠ” ë¬´ì¡°ê±´ backgroundë¡œ ìƒíƒœë¥¼ ë³´ë‚´ì„œ
 // "ì•„ë¬´ ì§ˆë¬¸ ì—†ìŒ" ìƒíƒœ(í°ìƒ‰ ë±ƒì§€)ë„ íƒ­ì— ì¦‰ì‹œ ë°˜ì˜ë˜ê²Œ í•œë‹¤.
 let hasSentInitialState = false;
@@ -19,6 +27,7 @@ const MIN_CHECK_GAP_MS = 250;
 let _checkScheduled = false;
 let _lastCheckAt = 0;
 function scheduleCheck() {
+  if (!monitoring) return;
   if (_checkScheduled) return;
   _checkScheduled = true;
   const now = Date.now();
@@ -36,6 +45,7 @@ function scheduleCheck() {
   }, delay);
 }
 function ensurePolling() {
+  if (!monitoring) return;
   if (checkInterval) return;
   checkInterval = window.setInterval(() => {
     scheduleCheck();
@@ -47,16 +57,12 @@ function isVisible(elem) {
   if (!elem) return false;
   return !!(elem.offsetWidth || elem.offsetHeight || elem.getClientRects().length);
 }
-function getPlatform() {
-  const host = window.location.hostname;
-  if (host.includes('chatgpt.com')) return 'chatgpt';
-  if (host.includes('gemini.google.com')) return 'gemini';
-  if (host.includes('aistudio.google.com')) return 'aistudio';
-  if (host.includes('claude.ai')) return 'claude';
-  return null;
+function getSiteKey() {
+  return activeSite?.key || null;
 }
 // íƒ­ ì œëª©(Title)ì— ë°°ì§€(ì´ëª¨ì§€) ë‹¬ê¸° - ì•„ì´ì½˜ ë°”ë¡œ ì˜†ì— í‘œì‹œë¨
 function updateTitleBadge() {
+  if (!monitoring) return;
   // 1. í˜„ì¬ ì œëª© ê°€ì ¸ì˜¤ê¸°
   const currentTitle = document.title;
   // 2. ì œëª© ì•ì˜ âšª/ğŸŸ /ğŸŸ¢ ë°°ì§€ ë° ê³µë°±ì„ ëª¨ë‘ ì œê±°í•˜ì—¬ ìˆœìˆ˜ ì œëª© ì¶”ì¶œ
@@ -72,37 +78,84 @@ function updateTitleBadge() {
     document.title = targetTitle;
   }
 }
+
+function clearTitleBadge() {
+  const currentTitle = document.title;
+  const cleanTitle = currentTitle.replace(/^([âšªğŸŸ ğŸŸ¢]\s?)+/, "");
+  if (cleanTitle !== currentTitle) document.title = cleanTitle;
+}
+
+// =========================
+// Generating detection rules
+// =========================
+function detectChatGPTGenerating() {
+  const btn = document.querySelector('[data-testid="stop-button"]');
+  return isVisible(btn);
+}
+
+function detectGeminiGenerating() {
+  // Gemini: "ì¤‘ì§€" ë˜ëŠ” "Stop" ë‹¨ì–´ê°€ ë“¤ì–´ê°„ ë²„íŠ¼ì´ í™”ë©´ì— ë³´ì´ëŠ”ì§€ í™•ì¸
+  const btns = document.querySelectorAll('[aria-label*="ì¤‘ì§€"], [aria-label*="Stop"], [aria-label*="stop"]');
+  return Array.from(btns).some((btn) => isVisible(btn));
+}
+
+function detectAiStudioGenerating() {
+  // AI Studio:
+  // 1. Google Material Icon ìì²´ê°€ 'stop', 'cancel', 'block' ì¸ì§€ í™•ì¸ (ê°€ì¥ í™•ì‹¤í•¨)
+  const icons = Array.from(document.querySelectorAll('mat-icon'));
+  const hasStopIcon = icons.some((icon) => {
+    const iconName = icon.innerText.trim().toLowerCase();
+    return ['stop', 'cancel', 'block', 'close'].includes(iconName) && isVisible(icon);
+  });
+  // 2. ë¡œë”©ë°” í™•ì¸
+  const progressBar = document.querySelector('mat-progress-bar');
+  return hasStopIcon || isVisible(progressBar);
+}
+
+function detectClaudeGenerating() {
+  // Claude: ë²„íŠ¼ í…ìŠ¤íŠ¸ì— "Stop"ì´ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
+  const buttons = Array.from(document.querySelectorAll('button, div[role="button"]'));
+  return buttons.some((btn) => btn.innerText.includes('Stop') && isVisible(btn));
+}
+
+function detectGenericStopGenerating() {
+  // ë²”ìš©: Stop/ì¤‘ì§€/Cancel/ì·¨ì†Œ/Abort í…ìŠ¤íŠ¸ or aria-label ê¸°ë°˜
+  // (ë“±ë¡ëœ ì‚¬ì´íŠ¸ì—ì„œë§Œ ì“°ì´ë¯€ë¡œ, ë„ˆë¬´ ê³µê²©ì ìœ¼ë¡œ ì¡ì§€ ì•ŠëŠ”ë‹¤)
+  const STOP_RE = /(\bstop\b|\bcancel\b|\babort\b|ì¤‘ì§€|ì·¨ì†Œ)/i;
+
+  const candidates = Array.from(document.querySelectorAll('button, [role="button"]'));
+  for (const el of candidates) {
+    if (!isVisible(el)) continue;
+    const aria = (el.getAttribute('aria-label') || '').trim();
+    const txt = (el.innerText || '').trim();
+    const hay = `${aria} ${txt}`.trim();
+    if (!hay) continue;
+    if (STOP_RE.test(hay)) return true;
+  }
+  return false;
+}
+
+function detectGenerating(site) {
+  const mode = site?.detection || 'generic_stop';
+  if (mode === 'chatgpt') return detectChatGPTGenerating();
+  if (mode === 'gemini') return detectGeminiGenerating();
+  if (mode === 'aistudio') return detectAiStudioGenerating();
+  if (mode === 'claude') return detectClaudeGenerating();
+  return detectGenericStopGenerating();
+}
+
 function checkStatus() {
-  const platform = getPlatform();
-  if (!platform) return;
+  if (!monitoring || !activeSite) return;
+
+  const platform = activeSite.key;
   let currentlyGenerating = false;
-  if (platform === 'chatgpt') {
-    const btn = document.querySelector('[data-testid="stop-button"]');
-    currentlyGenerating = isVisible(btn);
-  } 
-  else if (platform === 'gemini') {
-    // Gemini: "ì¤‘ì§€" ë˜ëŠ” "Stop" ë‹¨ì–´ê°€ ë“¤ì–´ê°„ ë²„íŠ¼ì´ í™”ë©´ì— ë³´ì´ëŠ”ì§€ í™•ì¸
-    const btns = document.querySelectorAll('[aria-label*="ì¤‘ì§€"], [aria-label*="Stop"], [aria-label*="stop"]');
-    currentlyGenerating = Array.from(btns).some(btn => isVisible(btn));
-  } 
-  else if (platform === 'aistudio') {
-    // AI Studio:
-    // 1. Google Material Icon ìì²´ê°€ 'stop', 'cancel', 'block' ì¸ì§€ í™•ì¸ (ê°€ì¥ í™•ì‹¤í•¨)
-    const icons = Array.from(document.querySelectorAll('mat-icon'));
-    const hasStopIcon = icons.some(icon => {
-      const iconName = icon.innerText.trim().toLowerCase();
-      return ['stop', 'cancel', 'block', 'close'].includes(iconName) && isVisible(icon);
-    });
-    // 2. ë¡œë”©ë°” í™•ì¸
-    const progressBar = document.querySelector('mat-progress-bar');
-    currentlyGenerating = hasStopIcon || isVisible(progressBar);
-  } 
-  else if (platform === 'claude') {
-    // Claude: ë²„íŠ¼ í…ìŠ¤íŠ¸ì— "Stop"ì´ í¬í•¨ë˜ì–´ ìˆëŠ”ì§€ í™•ì¸
-    // (ClaudeëŠ” divë‚˜ button ì•ˆì— "Stop" í…ìŠ¤íŠ¸ë¥¼ ëª…ì‹œì ìœ¼ë¡œ ë³´ì—¬ì¤Œ)
-    const buttons = Array.from(document.querySelectorAll('button, div[role="button"]'));
-    currentlyGenerating = buttons.some(btn => btn.innerText.includes('Stop') && isVisible(btn));
+
+  try {
+    currentlyGenerating = detectGenerating(activeSite);
+  } catch (_) {
+    currentlyGenerating = false;
   }
+
   // ìƒíƒœê°€ ë³€í–ˆì„ ë•Œë§Œ ì²˜ë¦¬
   if (isGenerating !== currentlyGenerating) {
     isGenerating = currentlyGenerating;
@@ -118,7 +171,8 @@ function checkStatus() {
     chrome.runtime.sendMessage({
       action: "status_update",
       platform,
-      isGenerating
+      siteName: activeSite.name,
+      isGenerating,
     });
     hasSentInitialState = true;
   } else if (!hasSentInitialState) {
@@ -126,7 +180,8 @@ function checkStatus() {
     chrome.runtime.sendMessage({
       action: "status_update",
       platform,
-      isGenerating
+      siteName: activeSite.name,
+      isGenerating,
     });
     hasSentInitialState = true;
   }
@@ -135,6 +190,7 @@ function checkStatus() {
 }
 // ì‚¬ìš©ì ìƒí˜¸ì‘ìš©(í´ë¦­/ìŠ¤í¬ë¡¤) ì‹œ ğŸŸ¢ -> âšª ì „í™˜ (ìš”êµ¬ì‚¬í•­)
 function markAsAcknowledged() {
+  if (!monitoring) return;
   if (isGenerating) return;
   if (completionStatus !== 'completed') return;
   completionStatus = 'idle';
@@ -142,33 +198,104 @@ function markAsAcknowledged() {
   // background(íˆ´ë°” ë°°ì§€)ë„ ê°™ì´ âšªë¡œ ë°”ê¿”ì¤€ë‹¤.
   chrome.runtime.sendMessage({
     action: 'user_activity',
-    platform: getPlatform(),
+    platform: getSiteKey(),
+    siteName: activeSite?.name,
     kind: 'ack'
   });
 }
-// ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
-// - focus/keydownìœ¼ë¡œëŠ” ì ˆëŒ€ ì§€ìš°ì§€ ì•ŠëŠ”ë‹¤.
-// - "í´ë¦­" ë˜ëŠ” "ìŠ¤í¬ë¡¤(íœ /ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸)"ë¡œë§Œ ğŸŸ¢ -> âšª
-document.addEventListener('click', markAsAcknowledged, true);
-document.addEventListener('scroll', markAsAcknowledged, true);
-document.addEventListener('wheel', markAsAcknowledged, { passive: true, capture: true });
-// íƒ­ í™œì„±/ë¹„í™œì„± ì „í™˜ ì‹œì—ë„ ìƒíƒœ ì¬í‰ê°€(ë°±ê·¸ë¼ìš´ë“œ ì™„ë£Œ ê°ì§€ ë³´ê°•)
-document.addEventListener('visibilitychange', scheduleCheck);
-// DOM ë³€í™”ë¥¼ ê°ì§€í•˜ì—¬ ì²´í¬ ì‹¤í–‰ (ì„±ëŠ¥ì„ ìœ„í•´ 1ì´ˆì— í•œ ë²ˆì”©ë§Œ ì²´í¬í•˜ë„ë¡ í•  ìˆ˜ë„ ìˆìŒ)
-// ì—¬ê¸°ì„œëŠ” MutationObserverë¥¼ ì‚¬ìš©í•˜ì—¬ ì‹¤ì‹œê°„ ë°˜ì‘ì„±ì„ ë†’ì…ë‹ˆë‹¤.
-const observer = new MutationObserver(() => {
+
+// =========================
+// Monitor lifecycle (start/stop) - registered sites only
+// =========================
+let _observer = null;
+let _handlersBound = false;
+
+function bindHandlersOnce() {
+  if (_handlersBound) return;
+  _handlersBound = true;
+  // ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ë“±ë¡
+  // - focus/keydownìœ¼ë¡œëŠ” ì ˆëŒ€ ì§€ìš°ì§€ ì•ŠëŠ”ë‹¤.
+  // - "í´ë¦­" ë˜ëŠ” "ìŠ¤í¬ë¡¤(íœ /ìŠ¤í¬ë¡¤ ì´ë²¤íŠ¸)"ë¡œë§Œ ğŸŸ¢ -> âšª
+  document.addEventListener('click', markAsAcknowledged, true);
+  document.addEventListener('scroll', markAsAcknowledged, true);
+  document.addEventListener('wheel', markAsAcknowledged, { passive: true, capture: true });
+  // íƒ­ í™œì„±/ë¹„í™œì„± ì „í™˜ ì‹œì—ë„ ìƒíƒœ ì¬í‰ê°€(ë°±ê·¸ë¼ìš´ë“œ ì™„ë£Œ ê°ì§€ ë³´ê°•)
+  document.addEventListener('visibilitychange', scheduleCheck);
+}
+
+function startMonitoring(site) {
+  if (monitoring && activeSite?.key === site?.key) return;
+
+  stopMonitoring();
+  activeSite = site;
+  monitoring = true;
+  isGenerating = false;
+  completionStatus = 'idle';
+  hasSentInitialState = false;
+
+  bindHandlersOnce();
+
+  // DOM ë³€í™”ë¥¼ ê°ì§€í•˜ì—¬ ì²´í¬ ì‹¤í–‰
+  _observer = new MutationObserver(() => {
+    scheduleCheck();
+  });
+  try {
+    _observer.observe(document.body, {
+      childList: true,
+      subtree: true,
+      // GeminiëŠ” childList ë³€í™” ì—†ì´ style/class/aria-labelë§Œ ë°”ë€ŒëŠ” ê²½ìš°ê°€ ìˆì–´
+      // attributes ê°ì‹œë¥¼ ì¼œì•¼ ğŸŸ  -> ğŸŸ¢ ì „í™˜ì„ ë†“ì¹˜ì§€ ì•ŠëŠ”ë‹¤.
+      attributes: true,
+      attributeFilter: ['aria-label', 'style', 'class', 'hidden', 'disabled']
+    });
+  } catch (_) {
+    // ì¼ë¶€ ë¬¸ì„œ(íŠ¹ìˆ˜ í”„ë ˆì„)ì—ì„œëŠ” observe ì‹¤íŒ¨í•  ìˆ˜ ìˆìŒ
+  }
+
+  ensurePolling();
   scheduleCheck();
-});
-// ê°ì‹œ ì‹œì‘
-observer.observe(document.body, {
-  childList: true,
-  subtree: true,
-  // GeminiëŠ” childList ë³€í™” ì—†ì´ style/class/aria-labelë§Œ ë°”ë€ŒëŠ” ê²½ìš°ê°€ ìˆì–´
-  // attributes ê°ì‹œë¥¼ ì¼œì•¼ ğŸŸ  -> ğŸŸ¢ ì „í™˜ì„ ë†“ì¹˜ì§€ ì•ŠëŠ”ë‹¤.
-  attributes: true,
-  attributeFilter: ['aria-label', 'style', 'class', 'hidden', 'disabled']
-});
-// ì´ˆê¸° ë¡œë“œ ì‹œ ìƒíƒœ í™•ì¸
-ensurePolling();
-scheduleCheck();
-console.log("AI ë‹µë³€ ê°ì‹œìê°€ ì‹œì‘ë˜ì—ˆìŠµë‹ˆë‹¤.");
\ No newline at end of file
+}
+
+function stopMonitoring() {
+  monitoring = false;
+  activeSite = null;
+  isGenerating = false;
+  completionStatus = 'idle';
+  hasSentInitialState = false;
+
+  if (checkInterval) {
+    clearInterval(checkInterval);
+    checkInterval = null;
+  }
+  if (_observer) {
+    try { _observer.disconnect(); } catch (_) {}
+    _observer = null;
+  }
+  clearTitleBadge();
+}
+
+function refreshSiteFromStorage() {
+  if (!window?.ReadyAi?.sites) return;
+
+  chrome.storage.local.get([
+    window.ReadyAi.sites.STORAGE_KEYS.ENABLED_SITES,
+    window.ReadyAi.sites.STORAGE_KEYS.CUSTOM_SITES,
+  ], (res) => {
+    const enabledSites = window.ReadyAi.sites.ensureEnabledSitesObject(res?.enabledSites);
+    const customSites = window.ReadyAi.sites.normalizeCustomSites(res?.customSites);
+    const site = window.ReadyAi.sites.resolveSiteFromConfig(window.location.href, enabledSites, customSites);
+    if (site) startMonitoring(site);
+    else stopMonitoring();
+  });
+}
+
+// ì„¤ì • ë³€ê²½ ì‹œ(íŒì—…ì—ì„œ ì‚¬ì´íŠ¸ on/off ë˜ëŠ” custom ì¶”ê°€/ì‚­ì œ) ì¦‰ì‹œ ë°˜ì˜
+try {
+  chrome.storage.onChanged.addListener((changes, area) => {
+    if (area !== 'local') return;
+    if (changes.enabledSites || changes.customSites) refreshSiteFromStorage();
+  });
+} catch (_) {}
+
+refreshSiteFromStorage();
+console.log('[Ready_Ai] content script loaded');
\ No newline at end of file
diff --git a/sources/src/popup.html b/sources/src/popup.html
index 6e8bee1..0f6279b 100644
--- a/sources/src/popup.html
+++ b/sources/src/popup.html
@@ -3,12 +3,44 @@
 <head>
   <meta charset="utf-8">
   <style>
-    body { width: 220px; padding: 15px; font-family: 'Segoe UI', sans-serif; }
+    body { width: 320px; padding: 15px; font-family: 'Segoe UI', sans-serif; }
     .header { display: flex; align-items: center; gap: 10px; margin-bottom: 20px; }
     .header img { width: 24px; height: 24px; }
     .header h2 { margin: 0; font-size: 16px; }
     .option { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
     .desc { font-size: 11px; color: #666; line-height: 1.4; }
+    .divider { height: 1px; background: #e6e6e6; margin: 14px 0; }
+    .section-title { font-size: 13px; font-weight: 600; margin: 0 0 8px 0; }
+    .site-list { display: flex; flex-direction: column; gap: 8px; }
+    .site-row { display: flex; justify-content: space-between; align-items: center; gap: 10px; }
+    .site-left { display: flex; flex-direction: column; gap: 2px; min-width: 0; }
+    .site-name { font-size: 12px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
+    .site-sub { font-size: 10px; color: #888; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
+
+    .custom-form { display: flex; flex-direction: column; gap: 8px; }
+    .field { display: flex; flex-direction: column; gap: 4px; }
+    .field label { font-size: 11px; color: #555; }
+    input[type="text"], textarea, select {
+      font-size: 12px;
+      padding: 6px 8px;
+      border: 1px solid #ccc;
+      border-radius: 8px;
+      outline: none;
+    }
+    textarea { resize: vertical; min-height: 46px; }
+    .row-actions { display: flex; gap: 8px; }
+    .btn {
+      border: 1px solid #ccc;
+      background: #fff;
+      border-radius: 10px;
+      padding: 6px 10px;
+      font-size: 12px;
+      cursor: pointer;
+    }
+    .btn.primary { border-color: #FFA500; }
+    .btn.danger { border-color: #ff6b6b; color: #b00000; }
+    .hint { font-size: 10px; color: #888; line-height: 1.35; }
+    .scroll { max-height: 520px; overflow: auto; padding-right: 4px; }
     /* Toggle Switch Style */
     .switch { position: relative; display: inline-block; width: 34px; height: 20px; }
     .switch input { opacity: 0; width: 0; height: 0; }
@@ -19,18 +51,57 @@
   </style>
 </head>
 <body>
-  <div class="header">
-    <img src="../assets/bell_profile.png" alt="Logo">
-    <h2>Ready_Ai</h2>
+  <div class="scroll">
+    <div class="header">
+      <img src="../assets/bell_profile.png" alt="Logo">
+      <h2>Ready_Ai</h2>
+    </div>
+
+    <div class="option">
+      <span>ë°©í•´ ê¸ˆì§€ ëª¨ë“œ ğŸŒ™</span>
+      <label class="switch">
+        <input type="checkbox" id="dnd-toggle">
+        <span class="slider"></span>
+      </label>
+    </div>
+    <div class="desc">í™œì„±í™” ì‹œ ì™„ë£Œ ì•Œë¦¼ íŒì—…ì´ ëœ¨ì§€ ì•ŠìŠµë‹ˆë‹¤. (ì•„ì´ì½˜ ë°°ì§€ëŠ” ê³„ì† í‘œì‹œë¨)</div>
+
+    <div class="divider"></div>
+
+    <div class="section-title">ì‚¬ì´íŠ¸ ë“±ë¡(ê¸°ë³¸)</div>
+    <div class="site-list" id="builtin-sites"></div>
+
+    <div class="divider"></div>
+
+    <div class="section-title">ì‚¬ì´íŠ¸ ë“±ë¡(ì§ì ‘ ì¶”ê°€)</div>
+    <div class="site-list" id="custom-sites"></div>
+    <div class="hint" style="margin: 8px 0 10px 0;">
+      URL íŒ¨í„´ì€ í¬ë¡¬ ë§¤ì¹˜íŒ¨í„´ìœ¼ë¡œ ì…ë ¥í•´. ì˜ˆ: <b>https://example.com/*</b> ë˜ëŠ” <b>https://*.example.com/*</b><br>
+      ì—¬ëŸ¬ ê°œëŠ” ì¤„ë°”ê¿ˆìœ¼ë¡œ ì¶”ê°€ ê°€ëŠ¥.
+    </div>
+
+    <div class="custom-form">
+      <div class="field">
+        <label>ì´ë¦„</label>
+        <input type="text" id="custom-name" placeholder="ì˜ˆ: Perplexity(íšŒì‚¬)" />
+      </div>
+      <div class="field">
+        <label>URL íŒ¨í„´(ì—¬ëŸ¬ ì¤„ ê°€ëŠ¥)</label>
+        <textarea id="custom-patterns" placeholder="https://example.com/*"></textarea>
+      </div>
+      <div class="field">
+        <label>ìƒì„±ì¤‘ ê°ì§€ ë°©ì‹</label>
+        <select id="custom-detection"></select>
+      </div>
+      <div class="row-actions">
+        <button class="btn primary" id="add-custom">ì¶”ê°€</button>
+        <button class="btn" id="reset-defaults">ê¸°ë³¸ê°’ ë³µêµ¬</button>
+      </div>
+      <div class="hint" id="status-hint"></div>
+    </div>
   </div>
-  <div class="option">
-    <span>ë°©í•´ ê¸ˆì§€ ëª¨ë“œ ğŸŒ™</span>
-    <label class="switch">
-      <input type="checkbox" id="dnd-toggle">
-      <span class="slider"></span>
-    </label>
-  </div>
-  <div class="desc">í™œì„±í™” ì‹œ ì™„ë£Œ ì•Œë¦¼ íŒì—…ì´ ëœ¨ì§€ ì•ŠìŠµë‹ˆë‹¤. (ì•„ì´ì½˜ ë°°ì§€ëŠ” ê³„ì† í‘œì‹œë¨)</div>
+
+  <script src="sites.js"></script>
   <script src="popup.js"></script>
 </body>
 </html>
\ No newline at end of file
diff --git a/sources/src/popup.js b/sources/src/popup.js
index f41406f..2a2d8c5 100644
--- a/sources/src/popup.js
+++ b/sources/src/popup.js
@@ -1,11 +1,256 @@
-document.addEventListener('DOMContentLoaded', () => {
-  const dndToggle = document.getElementById('dnd-toggle');
-  // ì €ì¥ëœ ì„¤ì • ë¶ˆëŸ¬ì˜¤ê¸°
-  chrome.storage.local.get(['dndMode'], (result) => {
-    dndToggle.checked = result.dndMode || false;
+function $(id) {
+  return document.getElementById(id);
+}
+
+function setHint(text, isError = false) {
+  const el = $('status-hint');
+  if (!el) return;
+  el.textContent = text || '';
+  el.style.color = isError ? '#b00000' : '#888';
+}
+
+function getSitesApi() {
+  return window?.ReadyAi?.sites;
+}
+
+function loadConfig(cb) {
+  const sitesApi = getSitesApi();
+  const enabledKey = sitesApi?.STORAGE_KEYS?.ENABLED_SITES || 'enabledSites';
+  const customKey = sitesApi?.STORAGE_KEYS?.CUSTOM_SITES || 'customSites';
+
+  chrome.storage.local.get(['dndMode', enabledKey, customKey], (res) => {
+    const enabledSites = sitesApi?.ensureEnabledSitesObject
+      ? sitesApi.ensureEnabledSitesObject(res?.[enabledKey])
+      : (res?.[enabledKey] || {});
+    const customSites = sitesApi?.normalizeCustomSites
+      ? sitesApi.normalizeCustomSites(res?.[customKey])
+      : (res?.[customKey] || []);
+
+    cb({
+      dndMode: !!res.dndMode,
+      enabledSites,
+      customSites,
+    });
   });
-  // ì„¤ì • ë³€ê²½ ì‹œ ì €ì¥
+}
+
+function saveConfig(cfg, cb) {
+  const sitesApi = getSitesApi();
+  const enabledKey = sitesApi?.STORAGE_KEYS?.ENABLED_SITES || 'enabledSites';
+  const customKey = sitesApi?.STORAGE_KEYS?.CUSTOM_SITES || 'customSites';
+  chrome.storage.local.set(
+    {
+      dndMode: !!cfg.dndMode,
+      [enabledKey]: cfg.enabledSites,
+      [customKey]: cfg.customSites,
+    },
+    () => cb?.()
+  );
+}
+
+function renderBuiltinSites(cfg) {
+  const sitesApi = getSitesApi();
+  const container = $('builtin-sites');
+  if (!container || !sitesApi?.BUILTIN_SITES) return;
+
+  container.innerHTML = '';
+
+  for (const s of sitesApi.BUILTIN_SITES) {
+    const row = document.createElement('div');
+    row.className = 'site-row';
+
+    const left = document.createElement('div');
+    left.className = 'site-left';
+
+    const name = document.createElement('div');
+    name.className = 'site-name';
+    name.textContent = s.name;
+
+    const sub = document.createElement('div');
+    sub.className = 'site-sub';
+    sub.textContent = (s.patterns || []).join(' , ');
+
+    left.appendChild(name);
+    left.appendChild(sub);
+
+    const switchWrap = document.createElement('label');
+    switchWrap.className = 'switch';
+
+    const input = document.createElement('input');
+    input.type = 'checkbox';
+    input.checked = !!cfg.enabledSites?.[s.key];
+
+    const slider = document.createElement('span');
+    slider.className = 'slider';
+
+    input.addEventListener('change', () => {
+      cfg.enabledSites[s.key] = input.checked;
+      saveConfig(cfg, () => {
+        setHint('ì €ì¥ë¨');
+      });
+    });
+
+    switchWrap.appendChild(input);
+    switchWrap.appendChild(slider);
+
+    row.appendChild(left);
+    row.appendChild(switchWrap);
+    container.appendChild(row);
+  }
+}
+
+function renderCustomSites(cfg) {
+  const sitesApi = getSitesApi();
+  const container = $('custom-sites');
+  if (!container || !sitesApi) return;
+
+  container.innerHTML = '';
+  const customSites = Array.isArray(cfg.customSites) ? cfg.customSites : [];
+
+  if (!customSites.length) {
+    const empty = document.createElement('div');
+    empty.className = 'desc';
+    empty.textContent = 'ì§ì ‘ ì¶”ê°€í•œ ì‚¬ì´íŠ¸ê°€ ì—†ìŠµë‹ˆë‹¤.';
+    container.appendChild(empty);
+    return;
+  }
+
+  for (const s of customSites) {
+    const row = document.createElement('div');
+    row.className = 'site-row';
+
+    const left = document.createElement('div');
+    left.className = 'site-left';
+
+    const name = document.createElement('div');
+    name.className = 'site-name';
+    name.textContent = s.name;
+
+    const modeLabel = sitesApi.DETECTION_MODES?.find((m) => m.key === s.detection)?.label || s.detection;
+    const sub = document.createElement('div');
+    sub.className = 'site-sub';
+    sub.textContent = `${modeLabel} Â· ${(s.patterns || []).join(' , ')}`;
+
+    left.appendChild(name);
+    left.appendChild(sub);
+
+    const actions = document.createElement('div');
+    actions.style.display = 'flex';
+    actions.style.alignItems = 'center';
+    actions.style.gap = '8px';
+
+    const switchWrap = document.createElement('label');
+    switchWrap.className = 'switch';
+
+    const input = document.createElement('input');
+    input.type = 'checkbox';
+    input.checked = !!s.enabled;
+    const slider = document.createElement('span');
+    slider.className = 'slider';
+    input.addEventListener('change', () => {
+      s.enabled = input.checked;
+      saveConfig(cfg, () => setHint('ì €ì¥ë¨'));
+    });
+    switchWrap.appendChild(input);
+    switchWrap.appendChild(slider);
+
+    const del = document.createElement('button');
+    del.className = 'btn danger';
+    del.textContent = 'ì‚­ì œ';
+    del.addEventListener('click', () => {
+      cfg.customSites = cfg.customSites.filter((x) => x.id !== s.id);
+      saveConfig(cfg, () => {
+        setHint('ì‚­ì œë¨');
+        renderCustomSites(cfg);
+      });
+    });
+
+    actions.appendChild(switchWrap);
+    actions.appendChild(del);
+
+    row.appendChild(left);
+    row.appendChild(actions);
+    container.appendChild(row);
+  }
+}
+
+function renderDetectionOptions() {
+  const sitesApi = getSitesApi();
+  const select = $('custom-detection');
+  if (!select || !sitesApi?.DETECTION_MODES) return;
+
+  select.innerHTML = '';
+  for (const m of sitesApi.DETECTION_MODES) {
+    const opt = document.createElement('option');
+    opt.value = m.key;
+    opt.textContent = m.label;
+    select.appendChild(opt);
+  }
+  select.value = 'generic_stop';
+}
+
+function wireActions(cfg) {
+  const dndToggle = $('dnd-toggle');
+  dndToggle.checked = !!cfg.dndMode;
   dndToggle.addEventListener('change', () => {
-    chrome.storage.local.set({ dndMode: dndToggle.checked });
+    cfg.dndMode = dndToggle.checked;
+    saveConfig(cfg, () => setHint('ì €ì¥ë¨'));
+  });
+
+  $('add-custom').addEventListener('click', () => {
+    const sitesApi = getSitesApi();
+    if (!sitesApi) return;
+
+    const name = String($('custom-name').value || '').trim();
+    const rawPatterns = $('custom-patterns').value;
+    const patterns = sitesApi.normalizePatterns(rawPatterns);
+    const detection = String($('custom-detection').value || 'generic_stop').trim();
+
+    if (!name) {
+      setHint('ì´ë¦„ì„ ì…ë ¥í•´ì¤˜', true);
+      return;
+    }
+    if (!patterns.length) {
+      setHint('URL íŒ¨í„´ì„ 1ê°œ ì´ìƒ ì…ë ¥í•´ì¤˜', true);
+      return;
+    }
+
+    const bad = patterns.find((p) => !sitesApi.isProbablyValidMatchPattern(p));
+    if (bad) {
+      setHint(`URL íŒ¨í„´ í˜•ì‹ì´ ì´ìƒí•¨: ${bad}`, true);
+      return;
+    }
+
+    const id = sitesApi.makeCustomId();
+    cfg.customSites = [...(cfg.customSites || []), { id, name, patterns, detection, enabled: true }];
+    saveConfig(cfg, () => {
+      $('custom-name').value = '';
+      $('custom-patterns').value = '';
+      $('custom-detection').value = 'generic_stop';
+      setHint('ì¶”ê°€ë¨');
+      renderCustomSites(cfg);
+    });
+  });
+
+  $('reset-defaults').addEventListener('click', () => {
+    const sitesApi = getSitesApi();
+    if (!sitesApi) return;
+    cfg.enabledSites = sitesApi.defaultEnabledSites();
+    cfg.customSites = [];
+    saveConfig(cfg, () => {
+      setHint('ê¸°ë³¸ê°’ìœ¼ë¡œ ë³µêµ¬ë¨');
+      renderBuiltinSites(cfg);
+      renderCustomSites(cfg);
+    });
+  });
+}
+
+document.addEventListener('DOMContentLoaded', () => {
+  renderDetectionOptions();
+  loadConfig((cfg) => {
+    setHint('');
+    renderBuiltinSites(cfg);
+    renderCustomSites(cfg);
+    wireActions(cfg);
   });
 });
\ No newline at end of file
diff --git a/sources/src/sites.js b/sources/src/sites.js
new file mode 100644
index 0000000..6f3519f
--- /dev/null
+++ b/sources/src/sites.js
@@ -0,0 +1,277 @@
+// Ready_Ai - Site registry (built-in + custom)
+//
+// ëª©í‘œ:
+// - íŒì—…ì—ì„œ "ì—¬ëŸ¬ ì‚¬ì´íŠ¸ ë“±ë¡"ì„ ê°€ëŠ¥í•˜ê²Œ í•œë‹¤.
+// - content scriptëŠ” <all_urls>ì— ì£¼ì…ë˜ì§€ë§Œ, ì‹¤ì œë¡œëŠ” "ë“±ë¡/í™œì„±"ëœ ì‚¬ì´íŠ¸ì—ì„œë§Œ
+//   ê°ì‹œ(í´ë§/MutationObserver/íƒ€ì´í‹€ ë±ƒì§€)ë¥¼ ì‹¤í–‰í•œë‹¤.
+// - ë“±ë¡í•œ ì‚¬ì´íŠ¸ê°€ ëŠ˜ì–´ë‚˜ë„, ì—¬ê¸°ë§Œ ê±´ë“œë¦¬ë©´ UI/ê°ì‹œ ë¡œì§ì´ ê°™ì´ í™•ì¥ë˜ê²Œ í•œë‹¤.
+
+(function () {
+  const STORAGE_KEYS = {
+    DND_MODE: 'dndMode',
+    ENABLED_SITES: 'enabledSites',
+    CUSTOM_SITES: 'customSites',
+  };
+
+  // detection:
+  // - chatgpt / gemini / aistudio / claude : ì „ìš© ê·œì¹™
+  // - generic_stop : "Stop/ì¤‘ì§€/Cancel/ì·¨ì†Œ" ë²„íŠ¼ ê°€ì‹œì„± ê¸°ë°˜ ë²”ìš© ê·œì¹™
+  const DETECTION_MODES = [
+    { key: 'chatgpt', label: 'ChatGPT ì „ìš©' },
+    { key: 'gemini', label: 'Gemini ì „ìš©' },
+    { key: 'aistudio', label: 'AI Studio ì „ìš©' },
+    { key: 'claude', label: 'Claude ì „ìš©' },
+    { key: 'generic_stop', label: 'ë²”ìš©(Stop/ì¤‘ì§€ ë²„íŠ¼)' },
+  ];
+
+  // "ë“±ë¡ ê°€ëŠ¥í•œ" ê¸°ë³¸ ì‚¬ì´íŠ¸ë“¤
+  // - ì‚¬ìš©ìê°€ íŒì—…ì—ì„œ on/off
+  // - ì¶”ê°€ë¡œ "ì§ì ‘ ì¶”ê°€"(customSites) ê°€ëŠ¥
+  const BUILTIN_SITES = [
+    {
+      key: 'chatgpt',
+      name: 'ChatGPT',
+      patterns: ['https://chatgpt.com/*'],
+      detection: 'chatgpt',
+      defaultEnabled: true,
+    },
+    {
+      key: 'gemini',
+      name: 'Gemini',
+      patterns: ['https://gemini.google.com/*'],
+      detection: 'gemini',
+      defaultEnabled: true,
+    },
+    {
+      key: 'aistudio',
+      name: 'AI Studio',
+      patterns: ['https://aistudio.google.com/*'],
+      detection: 'aistudio',
+      defaultEnabled: false,
+    },
+    {
+      key: 'claude',
+      name: 'Claude',
+      patterns: ['https://claude.ai/*'],
+      detection: 'claude',
+      defaultEnabled: false,
+    },
+    // ìì£¼ ì“°ëŠ” ê³³ë“¤(ë²”ìš© Stop ê·œì¹™)
+    {
+      key: 'perplexity',
+      name: 'Perplexity',
+      patterns: ['https://www.perplexity.ai/*', 'https://perplexity.ai/*'],
+      detection: 'generic_stop',
+      defaultEnabled: false,
+    },
+    {
+      key: 'poe',
+      name: 'Poe',
+      patterns: ['https://poe.com/*'],
+      detection: 'generic_stop',
+      defaultEnabled: false,
+    },
+    {
+      key: 'copilot',
+      name: 'Copilot',
+      patterns: ['https://copilot.microsoft.com/*'],
+      detection: 'generic_stop',
+      defaultEnabled: false,
+    },
+  ];
+
+  // =============== Match Pattern Utils (Chrome match patterns) ===============
+  const _patternRegexCache = new Map();
+
+  function escapeRegex(s) {
+    return s.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
+  }
+
+  // Chrome match pattern -> RegExp
+  // - <all_urls>
+  // - scheme://host/path
+  //   scheme: * | http | https
+  //   host: * | *.domain.com | domain.com
+  //   path: /* ì™€ì¼ë“œì¹´ë“œ
+  function matchPatternToRegex(pattern) {
+    if (_patternRegexCache.has(pattern)) return _patternRegexCache.get(pattern);
+
+    let re;
+    if (pattern === '<all_urls>') {
+      // content scriptëŠ” http/httpsì—ì„œë§Œ ì‹¤ì œë¡œ ì˜ë¯¸ê°€ ìˆìœ¼ë‹ˆ ìµœì†Œ ë²”ìœ„ë¡œ ì œí•œ
+      re = /^https?:\/\//i;
+      _patternRegexCache.set(pattern, re);
+      return re;
+    }
+
+    const parts = pattern.split('://');
+    if (parts.length !== 2) {
+      // ì‹¤íŒ¨ ì¼€ì´ìŠ¤ëŠ” í•­ìƒ false ë§¤ì¹­
+      re = /^$/;
+      _patternRegexCache.set(pattern, re);
+      return re;
+    }
+    const scheme = parts[0];
+    const rest = parts[1];
+
+    const slashIdx = rest.indexOf('/');
+    const hostPart = slashIdx >= 0 ? rest.slice(0, slashIdx) : rest;
+    const pathPart = slashIdx >= 0 ? rest.slice(slashIdx) : '/*';
+
+    const schemeRe = scheme === '*' ? 'https?' : escapeRegex(scheme);
+
+    let hostRe;
+    if (hostPart === '*') hostRe = '[^/]+?';
+    else if (hostPart.startsWith('*.')) {
+      const domain = hostPart.slice(2);
+      hostRe = `(?:[^/]+?\\.)?${escapeRegex(domain)}`;
+    } else hostRe = escapeRegex(hostPart);
+
+    // path: '*' -> '.*'
+    const pathEsc = escapeRegex(pathPart).replace(/\\\*/g, '.*');
+    re = new RegExp(`^${schemeRe}://${hostRe}${pathEsc}$`, 'i');
+    _patternRegexCache.set(pattern, re);
+    return re;
+  }
+
+  function urlMatchesPattern(url, pattern) {
+    try {
+      const re = matchPatternToRegex(pattern);
+      return re.test(url);
+    } catch (_) {
+      return false;
+    }
+  }
+
+  function urlMatchesAny(url, patterns) {
+    if (!patterns || !patterns.length) return false;
+    return patterns.some((p) => urlMatchesPattern(url, p));
+  }
+
+  function normalizePatterns(rawText) {
+    if (!rawText) return [];
+    if (Array.isArray(rawText)) {
+      return rawText
+        .map((s) => String(s || '').trim())
+        .filter(Boolean);
+    }
+    return String(rawText)
+      .split(/\r?\n|,|;/g)
+      .map((s) => s.trim())
+      .filter(Boolean);
+  }
+
+  function isProbablyValidMatchPattern(pattern) {
+    if (!pattern) return false;
+    if (pattern === '<all_urls>') return true;
+    // ë„ˆë¬´ ë¹¡ì„¸ê²Œ ê²€ì¦í•˜ë©´ ì‚¬ìš©ìê°€ ë‹µë‹µí•´í•˜ë‹ˆ, ìµœì†Œí•œë§Œ ì²´í¬
+    // - scheme://host/...
+    // - pathì— *ê°€ ì„ì¼ ìˆ˜ ìˆìŒ
+    const m = pattern.match(/^([*a-zA-Z]+):\/\/([^/]+)(\/.*)?$/);
+    if (!m) return false;
+    const scheme = m[1];
+    if (!(scheme === '*' || scheme === 'http' || scheme === 'https')) return false;
+    const host = m[2];
+    if (!host || host.includes(' ')) return false;
+    // hostì— '*' í—ˆìš©(*, *.domain)
+    if (host !== '*' && host.includes('*') && !host.startsWith('*.')) return false;
+    return true;
+  }
+
+  function defaultEnabledSites() {
+    const enabled = {};
+    for (const s of BUILTIN_SITES) enabled[s.key] = !!s.defaultEnabled;
+    return enabled;
+  }
+
+  function ensureEnabledSitesObject(enabledSites) {
+    const defaults = defaultEnabledSites();
+    if (!enabledSites || typeof enabledSites !== 'object') return defaults;
+    // ëˆ„ë½ëœ keyë§Œ ê¸°ë³¸ê°’ìœ¼ë¡œ ì±„ì›€(ê¸°ì¡´ ì„¤ì • ìœ ì§€)
+    for (const k of Object.keys(defaults)) {
+      if (!(k in enabledSites)) enabledSites[k] = defaults[k];
+    }
+    return enabledSites;
+  }
+
+  // custom site shape:
+  // {
+  //   id: "custom_xxx",
+  //   name: "ë‚´ ì‚¬ì´íŠ¸",
+  //   patterns: ["https://example.com/*"],
+  //   detection: "generic_stop",
+  //   enabled: true
+  // }
+  function normalizeCustomSites(customSites) {
+    if (!Array.isArray(customSites)) return [];
+    return customSites
+      .map((s) => {
+        const id = String(s?.id || '').trim();
+        const name = String(s?.name || '').trim() || 'Custom';
+        const patterns = normalizePatterns(s?.patterns);
+        const detection = String(s?.detection || 'generic_stop').trim();
+        const enabled = !!s?.enabled;
+        if (!id || !patterns.length) return null;
+        return { id, name, patterns, detection, enabled };
+      })
+      .filter(Boolean);
+  }
+
+  function resolveSiteFromConfig(url, enabledSites, customSites) {
+    const enabled = ensureEnabledSitesObject(enabledSites);
+    const customs = normalizeCustomSites(customSites);
+
+    // 1) custom ìš°ì„ (ì‚¬ìš©ì ëª…ì‹œ)
+    for (const c of customs) {
+      if (!c.enabled) continue;
+      if (urlMatchesAny(url, c.patterns)) {
+        return {
+          key: c.id,
+          name: c.name,
+          patterns: c.patterns,
+          detection: c.detection || 'generic_stop',
+          isCustom: true,
+        };
+      }
+    }
+
+    // 2) builtin
+    for (const s of BUILTIN_SITES) {
+      if (!enabled[s.key]) continue;
+      if (urlMatchesAny(url, s.patterns)) {
+        return {
+          key: s.key,
+          name: s.name,
+          patterns: s.patterns,
+          detection: s.detection,
+          isCustom: false,
+        };
+      }
+    }
+
+    return null;
+  }
+
+  // ê°„ë‹¨ UUID(ì¶©ëŒë§Œ í”¼í•˜ë©´ ë¨)
+  function makeCustomId() {
+    const rand = Math.random().toString(16).slice(2);
+    return `custom_${Date.now().toString(16)}_${rand}`;
+  }
+
+  // Export to global
+  window.ReadyAi = window.ReadyAi || {};
+  window.ReadyAi.sites = {
+    STORAGE_KEYS,
+    DETECTION_MODES,
+    BUILTIN_SITES,
+    matchPatternToRegex,
+    urlMatchesAny,
+    normalizePatterns,
+    isProbablyValidMatchPattern,
+    defaultEnabledSites,
+    ensureEnabledSitesObject,
+    normalizeCustomSites,
+    resolveSiteFromConfig,
+    makeCustomId,
+  };
+})();


(ì°¸ê³ : ì´ íŒŒì¼ì€ ë¶„ì„ëœ ì†ŒìŠ¤ ì½”ë“œê°€ í¬í•¨ë˜ì§€ ì•Šì€ ìƒíƒœë¡œ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.)